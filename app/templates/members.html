{% extends "base.html" %}
{% block content %}
<div class="flex items-center justify-between mb-4">
  <h2 class="section-title text-2xl md:text-3xl font-semibold">{{ t('Leden') }}</h2>
  <a href="{{ url_for('main.members_new') }}" class="btn btn-primary">{{ t('Nieuw lid') }}</a>
</div>

<div class="card table-card">
  <table class="w-full table-fixed text-left">
    <thead class="bg-gray-50">
      <tr>
        <th class="py-3 px-4">Name</th>
        <th class="py-3 px-4">Email</th>
        <th class="py-3 px-4 w-28">Phone</th>
        <th class="py-3 px-4">Address</th>
        <th class="py-3 px-4 w-36">Last Payment</th>
        <th class="py-3 px-4 w-28">Status</th>
        <th class="py-3 px-4 w-56 text-right">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for m in members %}
      <tr class="border-t">
        <td class="py-3 px-4 whitespace-nowrap font-medium">{{ m.first_name }} {{ m.last_name }}</td>
        <td class="py-3 px-4 break-words">{{ m.email or '-' }}</td>
        <td class="py-3 px-4">{{ m.phone or '-' }}</td>
        <td class="py-3 px-4 break-words">{{ m.address or '-' }}</td>
        <td class="py-3 px-4">
          {% if m.last_payment %}
            {{ m.last_payment.strftime('%Y-%m-%d') }}
          {% else %}
            <span class="text-orange-600">{{ t('No payment') }}</span>
          {% endif %}
        </td>
        <td class="py-3 px-4">
          <span class="badge {% if m.status == 'active' %}badge-success{% else %}badge-danger{% endif %}">
            {{ m.status or 'inactive' }}
          </span>
        </td>
        <td class="py-3 px-4">
          <div class="actions-row">
            <a class="icon-btn tooltip" href="{{ url_for('main.members_children', member_id=m.member_id) }}" aria-label="{{ t('Kinderen') }}" title="{{ t('Kinderen') }}" data-tooltip="{{ t('Kinderen') }}">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M22 21v-2a4 4 0 0 0-3-3.85"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
              </svg>
            </a>
            <a class="icon-btn tooltip" href="{{ url_for('main.members_payment', member_id=m.member_id) }}" aria-label="{{ t('Betaling') }}" title="{{ t('Betaling') }}" data-tooltip="{{ t('Betaling') }}">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="2" y="5" width="20" height="14" rx="2"/>
                <line x1="2" y1="10" x2="22" y2="10"/>
                <circle cx="7" cy="15" r="1"/>
                <circle cx="11" cy="15" r="1"/>
              </svg>
            </a>
            <a class="icon-btn icon-btn-primary tooltip" href="{{ url_for('main.members_edit', member_id=m.member_id) }}" aria-label="{{ t('Bewerken') }}" title="{{ t('Bewerken') }}" data-tooltip="{{ t('Bewerken') }}">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 20h9"/>
                <path d="M16.5 3.5l4 4L7 21H3v-4L16.5 3.5z"/>
              </svg>
            </a>
            <form method="POST" action="{{ url_for('main.members_delete', member_id=m.member_id) }}" onsubmit="return confirm('Lid verwijderen?');">
              <button class="icon-btn tooltip" data-tooltip="{{ t('Verwijderen') }}" aria-label="{{ t('Verwijderen') }}" title="{{ t('Verwijderen') }}">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 6h18"/>
                  <path d="M8 6V4h8v2"/>
                  <path d="M10 11v6"/>
                  <path d="M14 11v6"/>
                  <path d="M5 6l1 14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2l1-14"/>
                </svg>
              </button>
            </form>
          </div>
        </td>
      </tr>
      {% else %}
      <tr>
        <td class="py-6 px-4 text-gray-600" colspan="7">Geen leden gevonden. Voeg je eerste lid toe.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
